<!DOCTYPE html>
<html>

<head>
    <title>User Management System - Edit Profile</title>
    <link rel="stylesheet" href="styles/main.css">
    <link rel="stylesheet" href="styles/alert.css">
</head>

<body>
    <h1>Edit Profile</h1>

    <form id="editProfileForm">
        <label for="username">Username:</label>
        <input type="text" id="username" name="username">
        <br>
        <label for="email">Email:</label>
        <input type="email" id="email" name="email" required>
        <br>
        <label for="age">Age:</label>
        <input type="number" id="age" name="age"  required>
        <br>
        <label for="bio">Bio:</label>
        <textarea id="bio" name="bio" rows="10" required></textarea>
        <br>
        <input type="submit" value="Save">
    </form>
    <br>
    <a href="profile.html">Cancel</a>

    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script>
        document.getElementById('editProfileForm').addEventListener('submit', function (event) {
            event.preventDefault(); // Prevent the form from submitting normally

            // Collect form data
            const formData = new FormData(this);

            // Send AJAX request
            fetch('../scripts/edit_profile.php', {
                method: 'POST',
                body: formData,
                headers: { 'X-Requested-With': 'XMLHttpRequest' } // Set AJAX header
            })
            .then(response => response.json())
            .then(data => {
                // Handle the response from the server
                if (data.success) {
                    Swal.fire({
                        title: 'Profile Updated',
                        text: 'Your profile has been updated.',
                        icon: 'success'
                    }).then(() => {
                        // Redirect to profile.html after successful update
                        window.location.href = 'profile.html';
                    });
                } else {
                    Swal.fire({
                        title: 'Error',
                        text: 'An error occurred while updating your profile.',
                        icon: 'error'
                    });
                }
            })
            .catch(error => {
                console.error('Error:', error);
            });
        });
    </script>
</body>

</html>
